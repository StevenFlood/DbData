TOPIC
    about_DbData

SHORT DESCRIPTION
    ADO.NET SQL Server functionality in PowerShell.

LONG DESCRIPTION
    This module provides the infrastructure to use ADO.NET to SQL within PowerShell.
    * Build connection strings, and easily construct commands with parameters.
    * Enter and exit transactions.
    * Return data adapters (with schema and command builders), data sets, and data tables.

    Why not use SMO? SMO is designed for schema management whereas ADO.NET is about the data; it has better injection-safe commands with parameter support, data adapters, data sets, and data tables.

REQUIREMENTS
    Requires PowerShell 2.0 or later.
    Requires .NET 3.5 or later installed.
    High availability options passed to New-DbConnectionString require .NET 4.5 or later installed.

EXAMPLE #1
    This is how you'd connect to a database and select just the data from a table.

    New-DbConnectionString AG1L master | New-DbCommand "Select * From sys.master_files" | Get-DbData

EXAMPLE #2
    Connect to a database and get multiple result sets into different tables.

    $sql = New-DbConnection AG1L master | New-DbCommand "Select * From sys.databases; Select * From sys.master_files" | Get-DbData -TableMapping "Databases", "Files"
    $sql.Tables["Databases"]
    $sql.Tables["Files"]

EXAMPLE #3
    Connect to a database, begin a transaction, get an adapter to a table, add data, then rollback.

    $sql = New-DbConnection AG1L msdb | New-DbCommand "Select * From dbo.suspect_pages" | Enter-DbTransaction | Get-DbData

    # Add the row
    $row = $sql.DataSet.Tables[0].NewRow()
    $row.database_id = 1
    $row.file_id = 1
    $row.page_id = 1
    $row.event_type = 1
    $row.error_count = 1
    $row.last_update_date = (Get-Date).ToDateTime($null)
    $sql.DataSet.Tables[0].Rows.Add($row)

    # Update, it will be saved in the database at this point
    $sql.DataAdapter.Update($sql.DataSet)
    # But roll it back
    $sql.DataAdapter.SelectCommand | Exit-DbTransaction -Rollback

LINKS
